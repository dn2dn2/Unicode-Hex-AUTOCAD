<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoLISP Translator</title>
    <style>
        /* Thi·∫øt k·∫ø t·ªïng th·ªÉ hi·ªán ƒë·∫°i, c√¢n ƒë·ªëi */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: #f4f6f8; 
            margin: 0; padding: 40px 20px; 
            display: flex; justify-content: center;
        }

        .container {
            width: 100%; max-width: 900px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: border-top-color 0.3s;
            border-top: 6px solid #3498db; /* M·∫∑c ƒë·ªãnh m√†u xanh d∆∞∆°ng */
        }

        /* Header v√† Ti√™u ƒë·ªÅ */
        .header { text-align: center; padding: 25px 0 10px; }
        h1 { margin: 0; color: #2c3e50; font-size: 24px; text-transform: uppercase; letter-spacing: 1px; }

        /* KHU V·ª∞C ƒêI·ªÄU KHI·ªÇN (CONTROL PANEL) */
        .control-panel {
            background-color: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex; flex-direction: column; align-items: center; gap: 15px;
        }

        /* N√∫t chuy·ªÉn ƒë·ªïi ch·∫ø ƒë·ªô ch√≠nh (Tabs) */
        .mode-switch {
            display: flex; background: #e9ecef; border-radius: 30px; pading: 4px;
            position: relative; overflow: hidden;
        }
        .mode-switch label {
            padding: 10px 25px; cursor: pointer; font-weight: bold; color: #6c757d;
            transition: all 0.3s; z-index: 2; position: relative;
        }
        .mode-switch input { display: none; }
        
        /* Hi·ªáu ·ª©ng khi ch·ªçn Tab */
        .mode-switch input:checked + span {
            color: white;
        }
        /* Background tr∆∞·ª£t cho Tab (D√πng JS ƒë·ªÉ set class active) */
        .tab-active-blue { background-color: #3498db; border-radius: 30px; }
        .tab-active-green { background-color: #27ae60; border-radius: 30px; }


        /* T√πy ch·ªçn ph·ª• (Code/Text) */
        .sub-options {
            display: flex; gap: 20px; font-size: 14px;
            animation: fadeIn 0.3s ease-in-out;
        }
        .sub-options label { cursor: pointer; display: flex; align-items: center; gap: 5px; color: #555; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        .hidden { display: none !important; }

        /* KHU V·ª∞C NH·∫¨P LI·ªÜU */
        .io-area { padding: 30px; display: grid; gap: 20px; }
        
        .input-group label { display: block; font-weight: bold; margin-bottom: 8px; color: #34495e; font-size: 16px; }
        
        textarea {
            width: 100%; height: 200px; padding: 15px;
            border: 2px solid #e9ecef; border-radius: 8px;
            font-family: 'Courier New', monospace; font-size: 15px;
            box-sizing: border-box; resize: vertical; transition: border-color 0.3s;
        }
        textarea:focus { outline: none; border-color: #3498db; }

        .result-box { background-color: #f8f9fa; color: #333; font-weight: bold; }

        /* N√∫t Copy */
        .btn-copy {
            width: 100%; padding: 15px; border: none; border-radius: 8px;
            font-size: 16px; font-weight: bold; color: white; cursor: pointer;
            transition: background 0.3s, transform 0.1s;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-copy:active { transform: scale(0.98); }
        
        /* Classes m√†u s·∫Øc ƒë·ªông */
        .theme-blue textarea:focus { border-color: #3498db; }
        .theme-blue .btn-copy { background-color: #3498db; }
        .theme-blue .btn-copy:hover { background-color: #2980b9; }

        .theme-green textarea:focus { border-color: #27ae60; }
        .theme-green .btn-copy { background-color: #27ae60; }
        .theme-green .btn-copy:hover { background-color: #219150; }

    </style>
</head>
<body class="theme-blue"> <div class="container" id="mainContainer">
    <div class="header">
        <h1>B·ªô chuy·ªÉn ƒë·ªïi AutoLISP</h1>
    </div>

    <div class="control-panel">
        <div class="mode-switch">
            <label id="tabEncode" class="tab-active-blue" onclick="switchDirection('encode')">
                Ti·∫øng Vi·ªát ‚ûî AutoLISP
            </label>
            <label id="tabDecode" onclick="switchDirection('decode')">
                AutoLISP ‚ûî Ti·∫øng Vi·ªát
            </label>
        </div>

        <div class="sub-options" id="subOptions">
            <label><input type="radio" name="codeType" value="code" checked onchange="process()"> Nguy√™n Code (Code Block)</label>
            <label><input type="radio" name="codeType" value="text" onchange="process()"> VƒÉn b·∫£n th∆∞·ªùng (Raw Text)</label>
        </div>
    </div>

    <div class="io-area">
        <div class="input-group">
            <label id="lblInput">Nh·∫≠p n·ªôi dung Ti·∫øng Vi·ªát:</label>
            <textarea id="inputText" placeholder="V√≠ d·ª•: (alert &quot;Xin ch√†o&quot;)..." oninput="process()"></textarea>
        </div>

        <div class="input-group">
            <label id="lblOutput">K·∫øt qu·∫£ M√£ Lisp:</label>
            <textarea id="outputText" class="result-box" readonly></textarea>
        </div>

        <button class="btn-copy" onclick="copyResult()">üìã Sao ch√©p k·∫øt qu·∫£</button>
    </div>
</div>

<script>
    // Tr·∫°ng th√°i hi·ªán t·∫°i: 'encode' (Vi·ªát->Lisp) ho·∫∑c 'decode' (Lisp->Vi·ªát)
    let currentMode = 'encode';

    function switchDirection(mode) {
        currentMode = mode;
        const container = document.getElementById('mainContainer');
        const body = document.body;
        const subOpts = document.getElementById('subOptions');
        
        // Tab UI Elements
        const tabEncode = document.getElementById('tabEncode');
        const tabDecode = document.getElementById('tabDecode');
        
        // Text UI Elements
        const lblInput = document.getElementById('lblInput');
        const lblOutput = document.getElementById('lblOutput');
        const txtInput = document.getElementById('inputText');
        const txtOutput = document.getElementById('outputText');

        // Reset d·ªØ li·ªáu c≈© ƒë·ªÉ tr√°nh nh·∫ßm l·∫´n
        txtInput.value = "";
        txtOutput.value = "";

        if (mode === 'encode') {
            // Giao di·ªán ENCODE (Xanh D∆∞∆°ng)
            container.style.borderTopColor = "#3498db";
            body.className = "theme-blue";
            
            tabEncode.className = "tab-active-blue";
            tabEncode.style.color = "white";
            tabDecode.className = "";
            tabDecode.style.color = "#6c757d";

            subOpts.classList.remove('hidden'); // Hi·ªán t√πy ch·ªçn Code/Text
            
            lblInput.innerText = "Nh·∫≠p n·ªôi dung Ti·∫øng Vi·ªát:";
            lblOutput.innerText = "K·∫øt qu·∫£ M√£ Lisp:";
            txtInput.placeholder = 'V√≠ d·ª•: (alert "Xin ch√†o")...';
        } else {
            // Giao di·ªán DECODE (Xanh L√°)
            container.style.borderTopColor = "#27ae60";
            body.className = "theme-green";
            
            tabEncode.className = "";
            tabEncode.style.color = "#6c757d";
            tabDecode.className = "tab-active-green";
            tabDecode.style.color = "white";

            subOpts.classList.add('hidden'); // ·∫®n t√πy ch·ªçn Code/Text (kh√¥ng c·∫ßn thi·∫øt)
            
            lblInput.innerText = "D√°n M√£ Lisp (\\U+xxxx):";
            lblOutput.innerText = "N·ªôi dung Ti·∫øng Vi·ªát:";
            txtInput.placeholder = 'V√≠ d·ª•: \\U+0110\\U+00E3 xong...';
        }
    }

    // H√†m x·ª≠ l√Ω ch√≠nh (ƒêi·ªÅu h∆∞·ªõng d·ª±a tr√™n mode hi·ªán t·∫°i)
    function process() {
        if (currentMode === 'encode') {
            runEncode();
        } else {
            runDecode();
        }
    }

    // Logic M√£ h√≥a (Vi·ªát -> Lisp)
    function runEncode() {
        const input = document.getElementById('inputText').value;
        const type = document.querySelector('input[name="codeType"]:checked').value;
        let output = "";

        for (let i = 0; i < input.length; i++) {
            let charCode = input.charCodeAt(i);
            let char = input[i];

            if (type === "text") {
                // Mode Text: X·ª≠ l√Ω k·ªπ k√Ω t·ª± ƒë·∫∑c bi·ªát
                if (char === '"') output += '\\"';
                else if (char === '\\') output += '\\\\';
                else if (charCode > 127) output += "\\U+" + charCode.toString(16).toUpperCase().padStart(4, '0');
                else output += char;
            } else {
                // Mode Code Block: Gi·ªØ nguy√™n c·∫•u tr√∫c
                if (charCode > 127) output += "\\U+" + charCode.toString(16).toUpperCase().padStart(4, '0');
                else output += char;
            }
        }
        document.getElementById('outputText').value = output;
    }

    // Logic Gi·∫£i m√£ (Lisp -> Vi·ªát)
    function runDecode() {
        let input = document.getElementById('inputText').value;
        
        // 1. D·ªãch m√£ Unicode
        let output = input.replace(/\\U\+([0-9A-Fa-f]{4})/gi, (match, hexGroup) => {
            return String.fromCharCode(parseInt(hexGroup, 16));
        });

        // 2. L√†m s·∫°ch k√Ω t·ª± tho√°t (Escape characters) ƒë·ªÉ d·ªÖ ƒë·ªçc
        output = output.replace(/\\\\/g, '\\').replace(/\\"/g, '"');
        
        document.getElementById('outputText').value = output;
    }

    function copyResult() {
        const copyText = document.getElementById("outputText");
        copyText.select();
        copyText.setSelectionRange(0, 99999);
        
        if (navigator.clipboard) {
            navigator.clipboard.writeText(copyText.value)
                .then(() => alert("ƒê√£ sao ch√©p!"))
                .catch(err => console.error(err));
        } else {
            document.execCommand("copy");
            alert("ƒê√£ sao ch√©p!");
        }
    }
</script>

</body>
</html>
